{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Administrator\\\\Documents\\\\React\\\\indycare\\\\src\\\\components\\\\Robot\\\\EventHistory.js\";\nimport React from 'react';\nimport iconHistory from \"../../resources/Robot/icon-history.svg\";\nimport iconMore from \"../../resources/Robot/icon-more.svg\";\nimport { EventDataTable } from \"./EventDataTable\";\nimport $ from \"jquery\";\nimport { Modal } from \"./Modal\";\nimport Axios from \"axios\";\nexport class EventHistoryView extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.a = () => {\n      Axios.get('http://localhost:4000/datatable/events/' + this.props.sn + '/limit').then(res => {\n        console.log(\"a !!!!\");\n        const fake = [{\n          'code': 'dafdsfdsf',\n          'down': '1231321321321',\n          'file': null,\n          'occurrence_time': \"2019-01-01 11:11:11\",\n          'sn': 'D999'\n        }, {\n          'code': 'dafdsfdsf',\n          'down': '1231321321321',\n          'file': null,\n          'occurrence_time': \"2019-01-01 11:11:11\",\n          'sn': 'D999'\n        }, {\n          'code': 'dafdsfdsf',\n          'down': '1231321321321',\n          'file': null,\n          'occurrence_time': \"2019-01-01 11:11:11\",\n          'sn': 'D999'\n        }, {\n          'code': 'dafdsfdsf',\n          'down': '1231321321321',\n          'file': null,\n          'occurrence_time': \"2019-01-01 11:11:11\",\n          'sn': 'D999'\n        }, {\n          'code': 'dafdsfdsf',\n          'down': '1231321321321',\n          'file': null,\n          'occurrence_time': \"2019-01-01 11:11:11\",\n          'sn': 'D999'\n        }, {\n          'code': 'dafdsfdsf',\n          'down': '1231321321321',\n          'file': null,\n          'occurrence_time': \"2019-01-01 11:11:11\",\n          'sn': 'D999'\n        }, {\n          'code': 'dafdsfdsf',\n          'down': '1231321321321',\n          'file': null,\n          'occurrence_time': \"2019-01-01 11:11:11\",\n          'sn': 'D999'\n        }];\n        this.setState({\n          mainRes: fake\n        });\n      }).catch(e => {\n        alert(e);\n      });\n    };\n\n    this.openModal = () => {\n      $(this.refs.modal)[0].style.display = 'block';\n    };\n\n    this.closeModal = () => {\n      $(this.refs.modal)[0].style.display = 'none';\n    };\n\n    this.openModal = this.openModal.bind(this);\n    this.closeModal = this.closeModal.bind(this);\n    this.state = {\n      source: new EventSource(\"http://localhost:4000/stream?channel=\" + this.props.sn + \"_event\"),\n      mainRes: [],\n      modalRes: []\n    };\n  }\n\n  componentDidMount() {\n    let modal = $(this.refs.modal)[0];\n    const _this$state = this.state,\n          source = _this$state.source,\n          reload = _this$state.reload;\n    source.addEventListener('message', event => {\n      this.a();\n    });\n\n    window.onclick = event => {\n      if (event.target === modal) {\n        modal.style.display = \"none\";\n      }\n    };\n\n    Axios.get('http://localhost:4000/datatable/events/' + this.props.sn + '/limit').then(res => {\n      this.setState({\n        mainRes: res.data\n      });\n    }).catch(e => {\n      alert(e);\n    });\n    Axios.get('http://localhost:4000/datatable/events/' + this.props.sn + '/all').then(res => {\n      this.setState({\n        modalRes: res.data\n      });\n    }).catch(e => {\n      alert(e);\n    });\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      className: \"event_history\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"section_title\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 79\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      src: iconHistory,\n      alt: \"icon_event_history\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80\n      },\n      __self: this\n    }), React.createElement(\"h3\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81\n      },\n      __self: this\n    }, \"Event History\"), React.createElement(\"div\", {\n      className: \"more\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 82\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      id: \"history_Btn\",\n      onClick: this.openModal,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 83\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 84\n      },\n      __self: this\n    }, \"\\uB354\\uBCF4\\uAE30\"), React.createElement(\"img\", {\n      src: iconMore,\n      alt: \"icon_more\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 85\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      id: \"history_Modal\",\n      className: \"more_modal\",\n      ref: \"modal\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 87\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"modal-content\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      className: \"close\",\n      ref: \"close\",\n      onClick: this.closeModal,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89\n      },\n      __self: this\n    }, \"\\xD7\"), React.createElement(Modal, {\n      sn: this.props.sn,\n      data: this.state.modalRes,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90\n      },\n      __self: this\n    }))))), React.createElement(EventDataTable, {\n      sn: this.props.sn,\n      data: this.state.mainRes,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95\n      },\n      __self: this\n    }));\n  }\n\n}","map":{"version":3,"sources":["C:/Users/Administrator/Documents/React/indycare/src/components/Robot/EventHistory.js"],"names":["React","EventDataTable","$","Modal","Axios","EventHistoryView","Component","constructor","props","a","get","sn","then","res","console","log","fake","setState","mainRes","catch","e","alert","openModal","refs","modal","style","display","closeModal","bind","state","source","EventSource","modalRes","componentDidMount","reload","addEventListener","event","window","onclick","target","data","render","iconHistory","iconMore"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB;;;AAGA,SAAQC,cAAR,QAA6B,kBAA7B;AACA,OAAOC,CAAP,MAAc,QAAd;AACA,SAAQC,KAAR,QAAoB,SAApB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AAEA,OAAO,MAAMC,gBAAN,SAA+BL,KAAK,CAACM,SAArC,CAA+C;AAClDC,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACf,UAAMA,KAAN;;AADe,SAsCnBC,CAtCmB,GAsCf,MAAM;AACNL,MAAAA,KAAK,CAACM,GAAN,CAAU,4CAA4C,KAAKF,KAAL,CAAWG,EAAvD,GAA4D,QAAtE,EACKC,IADL,CACUC,GAAG,IAAI;AACTC,QAAAA,OAAO,CAACC,GAAR,CAAY,QAAZ;AACA,cAAMC,IAAI,GAAG,CACT;AAAC,kBAAQ,WAAT;AAAsB,kBAAQ,eAA9B;AAA+C,kBAAQ,IAAvD;AAA6D,6BAAmB,qBAAhF;AAAuG,gBAAM;AAA7G,SADS,EAET;AAAC,kBAAQ,WAAT;AAAsB,kBAAQ,eAA9B;AAA+C,kBAAQ,IAAvD;AAA6D,6BAAmB,qBAAhF;AAAuG,gBAAM;AAA7G,SAFS,EAGT;AAAC,kBAAQ,WAAT;AAAsB,kBAAQ,eAA9B;AAA+C,kBAAQ,IAAvD;AAA6D,6BAAmB,qBAAhF;AAAuG,gBAAM;AAA7G,SAHS,EAIT;AAAC,kBAAQ,WAAT;AAAsB,kBAAQ,eAA9B;AAA+C,kBAAQ,IAAvD;AAA6D,6BAAmB,qBAAhF;AAAuG,gBAAM;AAA7G,SAJS,EAKT;AAAC,kBAAQ,WAAT;AAAsB,kBAAQ,eAA9B;AAA+C,kBAAQ,IAAvD;AAA6D,6BAAmB,qBAAhF;AAAuG,gBAAM;AAA7G,SALS,EAMT;AAAC,kBAAQ,WAAT;AAAsB,kBAAQ,eAA9B;AAA+C,kBAAQ,IAAvD;AAA6D,6BAAmB,qBAAhF;AAAuG,gBAAM;AAA7G,SANS,EAOT;AAAC,kBAAQ,WAAT;AAAsB,kBAAQ,eAA9B;AAA+C,kBAAQ,IAAvD;AAA6D,6BAAmB,qBAAhF;AAAuG,gBAAM;AAA7G,SAPS,CAAb;AASA,aAAKC,QAAL,CAAc;AAACC,UAAAA,OAAO,EAAEF;AAAV,SAAd;AACH,OAbL,EAaOG,KAbP,CAaaC,CAAC,IAAI;AACdC,QAAAA,KAAK,CAACD,CAAD,CAAL;AACH,OAfD;AAgBH,KAvDkB;;AAAA,SA0DnBE,SA1DmB,GA0DP,MAAM;AACdpB,MAAAA,CAAC,CAAC,KAAKqB,IAAL,CAAUC,KAAX,CAAD,CAAmB,CAAnB,EAAsBC,KAAtB,CAA4BC,OAA5B,GAAsC,OAAtC;AACH,KA5DkB;;AAAA,SA8DnBC,UA9DmB,GA8DN,MAAM;AACfzB,MAAAA,CAAC,CAAC,KAAKqB,IAAL,CAAUC,KAAX,CAAD,CAAmB,CAAnB,EAAsBC,KAAtB,CAA4BC,OAA5B,GAAsC,MAAtC;AACH,KAhEkB;;AAEf,SAAKJ,SAAL,GAAiB,KAAKA,SAAL,CAAeM,IAAf,CAAoB,IAApB,CAAjB;AACA,SAAKD,UAAL,GAAkB,KAAKA,UAAL,CAAgBC,IAAhB,CAAqB,IAArB,CAAlB;AACA,SAAKC,KAAL,GAAa;AACTC,MAAAA,MAAM,EAAE,IAAIC,WAAJ,CAAgB,0CAClB,KAAKvB,KAAL,CAAWG,EADO,GACF,QADd,CADC;AAGTO,MAAAA,OAAO,EAAE,EAHA;AAITc,MAAAA,QAAQ,EAAE;AAJD,KAAb;AAMH;;AAEDC,EAAAA,iBAAiB,GAAG;AAChB,QAAIT,KAAK,GAAGtB,CAAC,CAAC,KAAKqB,IAAL,CAAUC,KAAX,CAAD,CAAmB,CAAnB,CAAZ;AADgB,wBAES,KAAKK,KAFd;AAAA,UAETC,MAFS,eAETA,MAFS;AAAA,UAEDI,MAFC,eAEDA,MAFC;AAGhBJ,IAAAA,MAAM,CAACK,gBAAP,CAAwB,SAAxB,EAAmCC,KAAK,IAAI;AACxC,WAAK3B,CAAL;AACH,KAFD;;AAGA4B,IAAAA,MAAM,CAACC,OAAP,GAAkBF,KAAD,IAAW;AACxB,UAAIA,KAAK,CAACG,MAAN,KAAiBf,KAArB,EAA4B;AACxBA,QAAAA,KAAK,CAACC,KAAN,CAAYC,OAAZ,GAAsB,MAAtB;AACH;AACJ,KAJD;;AAKAtB,IAAAA,KAAK,CAACM,GAAN,CAAU,4CAA4C,KAAKF,KAAL,CAAWG,EAAvD,GAA4D,QAAtE,EACKC,IADL,CACUC,GAAG,IAAI;AACT,WAAKI,QAAL,CAAc;AAACC,QAAAA,OAAO,EAAEL,GAAG,CAAC2B;AAAd,OAAd;AACH,KAHL,EAGOrB,KAHP,CAGaC,CAAC,IAAI;AACdC,MAAAA,KAAK,CAACD,CAAD,CAAL;AACH,KALD;AAMAhB,IAAAA,KAAK,CAACM,GAAN,CAAU,4CAA4C,KAAKF,KAAL,CAAWG,EAAvD,GAA4D,MAAtE,EACKC,IADL,CACUC,GAAG,IAAI;AACT,WAAKI,QAAL,CAAc;AAACe,QAAAA,QAAQ,EAAEnB,GAAG,CAAC2B;AAAf,OAAd;AACH,KAHL,EAGOrB,KAHP,CAGaC,CAAC,IAAI;AACdC,MAAAA,KAAK,CAACD,CAAD,CAAL;AACH,KALD;AAOH;;AA8BDqB,EAAAA,MAAM,GAAG;AACL,WACI;AAAK,MAAA,SAAS,EAAC,eAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAK,MAAA,SAAS,EAAC,eAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAK,MAAA,GAAG,EAAEC,WAAV;AAAuB,MAAA,GAAG,EAAC,oBAA3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADJ,EAEI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAFJ,EAGI;AAAK,MAAA,SAAS,EAAC,MAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAQ,MAAA,EAAE,EAAC,aAAX;AAAyB,MAAA,OAAO,EAAE,KAAKpB,SAAvC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4BADJ,EAEI;AAAK,MAAA,GAAG,EAAEqB,QAAV;AAAoB,MAAA,GAAG,EAAC,WAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFJ,CADJ,EAKI;AAAK,MAAA,EAAE,EAAC,eAAR;AAAwB,MAAA,SAAS,EAAC,YAAlC;AAA+C,MAAA,GAAG,EAAC,OAAnD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAK,MAAA,SAAS,EAAC,eAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAM,MAAA,SAAS,EAAC,OAAhB;AAAwB,MAAA,GAAG,EAAC,OAA5B;AAAoC,MAAA,OAAO,EAAE,KAAKhB,UAAlD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cADJ,EAEI,oBAAC,KAAD;AAAO,MAAA,EAAE,EAAE,KAAKnB,KAAL,CAAWG,EAAtB;AAA0B,MAAA,IAAI,EAAE,KAAKkB,KAAL,CAAWG,QAA3C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFJ,CADJ,CALJ,CAHJ,CADJ,EAiBI,oBAAC,cAAD;AAAgB,MAAA,EAAE,EAAE,KAAKxB,KAAL,CAAWG,EAA/B;AAAmC,MAAA,IAAI,EAAE,KAAKkB,KAAL,CAAWX,OAApD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAjBJ,CADJ;AAqBH;;AAzFiD","sourcesContent":["import React from 'react';\r\nimport iconHistory from \"../../resources/Robot/icon-history.svg\";\r\nimport iconMore from \"../../resources/Robot/icon-more.svg\";\r\nimport {EventDataTable} from \"./EventDataTable\";\r\nimport $ from \"jquery\";\r\nimport {Modal} from \"./Modal\";\r\nimport Axios from \"axios\";\r\n\r\nexport class EventHistoryView extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.openModal = this.openModal.bind(this);\r\n        this.closeModal = this.closeModal.bind(this);\r\n        this.state = {\r\n            source: new EventSource(\"http://localhost:4000/stream?channel=\"\r\n                + this.props.sn + \"_event\"),\r\n            mainRes: [],\r\n            modalRes: []\r\n        };\r\n    }\r\n\r\n    componentDidMount() {\r\n        let modal = $(this.refs.modal)[0];\r\n        const {source, reload} = this.state;\r\n        source.addEventListener('message', event => {\r\n            this.a();\r\n        });\r\n        window.onclick = (event) => {\r\n            if (event.target === modal) {\r\n                modal.style.display = \"none\";\r\n            }\r\n        };\r\n        Axios.get('http://localhost:4000/datatable/events/' + this.props.sn + '/limit')\r\n            .then(res => {\r\n                this.setState({mainRes: res.data});\r\n            }).catch(e => {\r\n            alert(e);\r\n        });\r\n        Axios.get('http://localhost:4000/datatable/events/' + this.props.sn + '/all')\r\n            .then(res => {\r\n                this.setState({modalRes: res.data});\r\n            }).catch(e => {\r\n            alert(e);\r\n        });\r\n\r\n    }\r\n\r\n    a = () => {\r\n        Axios.get('http://localhost:4000/datatable/events/' + this.props.sn + '/limit')\r\n            .then(res => {\r\n                console.log(\"a !!!!\");\r\n                const fake = [\r\n                    {'code': 'dafdsfdsf', 'down': '1231321321321', 'file': null, 'occurrence_time': \"2019-01-01 11:11:11\", 'sn': 'D999'},\r\n                    {'code': 'dafdsfdsf', 'down': '1231321321321', 'file': null, 'occurrence_time': \"2019-01-01 11:11:11\", 'sn': 'D999'},\r\n                    {'code': 'dafdsfdsf', 'down': '1231321321321', 'file': null, 'occurrence_time': \"2019-01-01 11:11:11\", 'sn': 'D999'},\r\n                    {'code': 'dafdsfdsf', 'down': '1231321321321', 'file': null, 'occurrence_time': \"2019-01-01 11:11:11\", 'sn': 'D999'},\r\n                    {'code': 'dafdsfdsf', 'down': '1231321321321', 'file': null, 'occurrence_time': \"2019-01-01 11:11:11\", 'sn': 'D999'},\r\n                    {'code': 'dafdsfdsf', 'down': '1231321321321', 'file': null, 'occurrence_time': \"2019-01-01 11:11:11\", 'sn': 'D999'},\r\n                    {'code': 'dafdsfdsf', 'down': '1231321321321', 'file': null, 'occurrence_time': \"2019-01-01 11:11:11\", 'sn': 'D999'}\r\n                ];\r\n                this.setState({mainRes: fake});\r\n            }).catch(e => {\r\n            alert(e);\r\n        });\r\n    };\r\n\r\n    // 가능하면 Modal은 하위 Component의 isOpen State를 전달함으로써 컨트롤 해야 함. 현재 CSS 이용.\r\n    openModal = () => {\r\n        $(this.refs.modal)[0].style.display = 'block';\r\n    };\r\n\r\n    closeModal = () => {\r\n        $(this.refs.modal)[0].style.display = 'none';\r\n    };\r\n\r\n    render() {\r\n        return (\r\n            <div className=\"event_history\">\r\n                <div className=\"section_title\">\r\n                    <img src={iconHistory} alt=\"icon_event_history\"/>\r\n                    <h3>Event History</h3>\r\n                    <div className=\"more\">\r\n                        <button id=\"history_Btn\" onClick={this.openModal}>\r\n                            <span>더보기</span>\r\n                            <img src={iconMore} alt=\"icon_more\"/>\r\n                        </button>\r\n                        <div id=\"history_Modal\" className=\"more_modal\" ref='modal'>\r\n                            <div className=\"modal-content\">\r\n                                <span className=\"close\" ref='close' onClick={this.closeModal}>&times;</span>\r\n                                <Modal sn={this.props.sn} data={this.state.modalRes}/>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <EventDataTable sn={this.props.sn} data={this.state.mainRes}/>\r\n            </div>\r\n        );\r\n    }\r\n}"]},"metadata":{},"sourceType":"module"}
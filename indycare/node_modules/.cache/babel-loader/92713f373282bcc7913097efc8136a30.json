{"ast":null,"code":"import _classCallCheck from\"C:\\\\Users\\\\Administrator\\\\Documents\\\\React\\\\indycare\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\Administrator\\\\Documents\\\\React\\\\indycare\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"C:\\\\Users\\\\Administrator\\\\Documents\\\\React\\\\indycare\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"C:\\\\Users\\\\Administrator\\\\Documents\\\\React\\\\indycare\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";import _assertThisInitialized from\"C:\\\\Users\\\\Administrator\\\\Documents\\\\React\\\\indycare\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";import _inherits from\"C:\\\\Users\\\\Administrator\\\\Documents\\\\React\\\\indycare\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import React from'react';import iconHistory from\"../../resources/Robot/icon-history.svg\";import iconMore from\"../../resources/Robot/icon-more.svg\";import{EventDataTable}from\"./EventDataTable\";import $ from\"jquery\";import{Modal}from\"./Modal\";import Axios from\"axios\";export var EventHistoryView=/*#__PURE__*/function(_React$Component){_inherits(EventHistoryView,_React$Component);function EventHistoryView(props){var _this;_classCallCheck(this,EventHistoryView);_this=_possibleConstructorReturn(this,_getPrototypeOf(EventHistoryView).call(this,props));_this.getMainData=function(){Axios.get('http://localhost:4000/datatable/events/'+_this.props.sn+'/limit').then(function(res){_this.setState({mainRes:res.data});}).catch(function(e){alert(e);});};_this.getModalData=function(){Axios.get('http://localhost:4000/datatable/events/'+_this.props.sn+'/all').then(function(res){_this.setState({modalRes:res.data});}).catch(function(e){alert(e);});};_this.openModal=function(){$(_this.refs.modal)[0].style.display='block';};_this.closeModal=function(){$(_this.refs.modal)[0].style.display='none';};_this.openModal=_this.openModal.bind(_assertThisInitialized(_this));_this.closeModal=_this.closeModal.bind(_assertThisInitialized(_this));_this.getMainData=_this.getMainData.bind(_assertThisInitialized(_this));_this.getModalData=_this.getModalData.bind(_assertThisInitialized(_this));_this.state={source:new EventSource(\"http://localhost:4000/stream?channel=\"+_this.props.sn+\"_event\"),mainRes:[],modalRes:[]};return _this;}_createClass(EventHistoryView,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;var modal=$(this.refs.modal)[0];var source=this.state.source;source.addEventListener('message',function(event){_this2.getMainData();_this2.getModalData();});window.onclick=function(event){if(event.target===modal){modal.style.display=\"none\";}};this.getMainData();this.getModalData();}},{key:\"render\",value:function render(){return React.createElement(\"div\",{className:\"event_history\"},React.createElement(\"div\",{className:\"section_title\"},React.createElement(\"img\",{src:iconHistory,alt:\"icon_event_history\"}),React.createElement(\"h3\",null,\"Event History\"),React.createElement(\"div\",{className:\"more\"},React.createElement(\"button\",{id:\"history_Btn\",onClick:this.openModal},React.createElement(\"span\",null,\"\\uB354\\uBCF4\\uAE30\"),React.createElement(\"img\",{src:iconMore,alt:\"icon_more\"})),React.createElement(\"div\",{id:\"history_Modal\",className:\"more_modal\",ref:\"modal\"},React.createElement(\"div\",{className:\"modal-content\"},React.createElement(\"span\",{className:\"close\",ref:\"close\",onClick:this.closeModal},\"\\xD7\"),React.createElement(Modal,{sn:this.props.sn,data:this.state.modalRes}))))),React.createElement(EventDataTable,{sn:this.props.sn,data:this.state.mainRes}));}}]);return EventHistoryView;}(React.Component);","map":{"version":3,"sources":["C:/Users/Administrator/Documents/React/indycare/src/components/Robot/EventHistory.js"],"names":["React","EventDataTable","$","Modal","Axios","EventHistoryView","props","getMainData","get","sn","then","res","setState","mainRes","data","catch","e","alert","getModalData","modalRes","openModal","refs","modal","style","display","closeModal","bind","state","source","EventSource","addEventListener","event","window","onclick","target","iconHistory","iconMore","Component"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport iconHistory from \"../../resources/Robot/icon-history.svg\";\r\nimport iconMore from \"../../resources/Robot/icon-more.svg\";\r\nimport {EventDataTable} from \"./EventDataTable\";\r\nimport $ from \"jquery\";\r\nimport {Modal} from \"./Modal\";\r\nimport Axios from \"axios\";\r\n\r\nexport class EventHistoryView extends React.Component {\r\n    constructor(props) {\r\n        super(props);\r\n        this.openModal = this.openModal.bind(this);\r\n        this.closeModal = this.closeModal.bind(this);\r\n        this.getMainData = this.getMainData.bind(this);\r\n        this.getModalData = this.getModalData.bind(this);\r\n        this.state = {\r\n            source: new EventSource(\"http://localhost:4000/stream?channel=\"\r\n                + this.props.sn + \"_event\"),\r\n            mainRes: [],\r\n            modalRes: []\r\n        };\r\n    }\r\n\r\n    componentDidMount() {\r\n        let modal = $(this.refs.modal)[0];\r\n        const {source} = this.state;\r\n        source.addEventListener('message', event => {\r\n            this.getMainData();\r\n            this.getModalData();\r\n        });\r\n        window.onclick = (event) => {\r\n            if (event.target === modal) {\r\n                modal.style.display = \"none\";\r\n            }\r\n        };\r\n        this.getMainData();\r\n        this.getModalData();\r\n    }\r\n\r\n    getMainData = () => {\r\n        Axios.get('http://localhost:4000/datatable/events/' + this.props.sn + '/limit')\r\n            .then(res => {\r\n                this.setState({mainRes: res.data});\r\n            }).catch(e => {\r\n            alert(e);\r\n        });\r\n    };\r\n\r\n    getModalData = () => {\r\n        Axios.get('http://localhost:4000/datatable/events/' + this.props.sn + '/all')\r\n            .then(res => {\r\n                this.setState({modalRes: res.data});\r\n            }).catch(e => {\r\n            alert(e);\r\n        });\r\n    };\r\n\r\n    // 가능하면 Modal은 하위 Component의 isOpen State를 전달함으로써 컨트롤 해야 함. 현재 CSS 이용.\r\n    openModal = () => {\r\n        $(this.refs.modal)[0].style.display = 'block';\r\n    };\r\n\r\n    closeModal = () => {\r\n        $(this.refs.modal)[0].style.display = 'none';\r\n    };\r\n\r\n    render() {\r\n        return (\r\n            <div className=\"event_history\">\r\n                <div className=\"section_title\">\r\n                    <img src={iconHistory} alt=\"icon_event_history\"/>\r\n                    <h3>Event History</h3>\r\n                    <div className=\"more\">\r\n                        <button id=\"history_Btn\" onClick={this.openModal}>\r\n                            <span>더보기</span>\r\n                            <img src={iconMore} alt=\"icon_more\"/>\r\n                        </button>\r\n                        <div id=\"history_Modal\" className=\"more_modal\" ref='modal'>\r\n                            <div className=\"modal-content\">\r\n                                <span className=\"close\" ref='close' onClick={this.closeModal}>&times;</span>\r\n                                <Modal sn={this.props.sn} data={this.state.modalRes}/>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <EventDataTable sn={this.props.sn} data={this.state.mainRes}/>\r\n            </div>\r\n        );\r\n    }\r\n}"]},"metadata":{},"sourceType":"module"}